# -*- rst -*-

-------------------------------------------------
Notes about multi-lingual gnucash website content
-------------------------------------------------

- all pages must call lang.php to bring in gettext support.
- It would be nice to use the same containing structure for all translations.
- Phrase content can probably be po-style translated well.
- Body/paragraph content probably wants to be block-replaced.
- We're fine not doing auto-language negotiation.

----------------------------------------
www.gnucash.org coding conventions/notes
----------------------------------------

There are three main classes of links:

- external resources [$top_dir[/externals]]
  - www: relative
  - !www: relative

- translations [$top_dir/[«lang»]]
  - www: relative
  - !www: relative

- navigation [$home]
  - www: relative
  - !www: url-prefixed ("http://www.gnucash.org/file.phtml")

                        | www.gnucash.org  |  lists.gnucash.org        |
                        +------------------+---------------------------+
           external (C) |   ./[externals/] |  ./[externals/]           | \
        external (lang) |  ../[externals/] | ../[externals/]           |  \,- $top_dir
        translation (C) |   ./[lang]       |  ./[lang]                 |  / 
     translation (lang) |  ../[lang]       | ../[lang]                 | /
         navigation (C) |   ./             | http://www.[...]/         |  \,- $home
      navigation (lang) |   ./             | http://www.[...]/[lang]/  |  /

As such:

  $top_dir := the relative reference to the top of the relative website; this
    should be used for language-independent resources (stylesheets, images, php
    includes), but not for links...

  $home := a prefix for navigational URLs; for everything but
    lists.gnucash.org, this'll be ".", but for lists.gnucash.org it'll
    be "http://www.gnucash.org/".

As well, the following variables should be set:
...per directory:

  $locale := the LANG to use for gettext.

...per file:

  $title := the text of the page.

  $homepage := if the file is the homepage; controls RSS feed linkage.

----------------------
Preparing translations
----------------------

    $ ./create-potfiles.pl > po/POTFILES
    $ ./make-pot.sh

Now merge the new content into your translation, substituting the name of 
your po file in the command:

    $ msgmerge po/en_GB.po po/gnucash-htdocs.pot -o po/en_GB.po

Finally, see the size of the task ahead:

    $ msgfmt -c --statistics po/en_GB.po

Whilst editing the translation, run the msgfmt command from time to time to catch
errors and let you know how much is left to do.

When you come across fuzzy markers: (#, fuzzy), remove them.

When you have no fuzzy and no untranslated messages, update the binary translation file:

    $ msgfmt po/en_GB.po -o en_GB/LC_MESSAGES/gnucash-htdocs.mo
